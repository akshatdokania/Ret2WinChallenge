#!/usr/bin/env python3

from pwn import *
import ctypes

# Configuration
HOST = '127.0.0.1'
PORT = 11111

# Function to generate the secret password based on the srand seed and rand function
def generate_password(length):
    libc = ctypes.CDLL("libc.so.6")
    libc.srand(1337)
    password = ""
    for _ in range(length):
        password += chr((libc.rand() % 26) + ord('A'))
    return password

def main():
    # Password length as defined in the target binary
    password_length = 8
    
    # Generate the secret password using the known srand seed
    secret_password = generate_password(password_length)
    print(f"[+] Generated password: {secret_password}")

    # Connect to the remote target
    p = remote(HOST, PORT)

    # Interact with the binary
    print(p.recvuntil(b"Enter the password: ").decode())
    p.sendline(secret_password.encode())
    
    # Print the response from the binary
    print(p.recvall().decode())

if __name__ == "__main__":
    main()
